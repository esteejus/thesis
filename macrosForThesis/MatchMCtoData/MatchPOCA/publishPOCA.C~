#include "/home/justin/mythesis/thesis_style.h"

using namespace style;

void publishPOCA()
{
  gStyle->SetErrorX(0);

  TFile *f = TFile::Open("angles_poca.root");
  TH1D *mc_p = (TH1D *)f->Get("poca_mc_p");
  TH1D *data_p = (TH1D *)f->Get("poca_p");

  TH1D *mc_d = (TH1D *)f->Get("poca_mc_d");
  TH1D *data_d = (TH1D *)f->Get("poca_d");

  TH1D *mc_t = (TH1D *)f->Get("poca_mc_t");
  TH1D *data_t = (TH1D *)f->Get("poca_t");

  TH1D *mc_he3 = (TH1D *)f->Get("poca_mc_he3");
  TH1D *data_he3 = (TH1D *)f->Get("poca_he3");

  TH1D *mc_he4 = (TH1D *)f->Get("poca_mc_he4");
  TH1D *data_he4 = (TH1D *)f->Get("poca_he4");

  data_p->GetYaxis()->SetTitle("Probability");
  data_p->GetXaxis()->SetTitle("Dist. to Vertex [mm]");

  data_p->GetYaxis()->SetMaxDigits(2);
  mc_p->GetYaxis()->SetMaxDigits(2);
  
  TCanvas *cvs = style::stdcvs();
  make(data_p);
  make(mc_p);
  make(data_d);
  make(mc_d);
  make(data_t);
  make(mc_t);
  make(data_he3);
  make(mc_he3);
  make(data_he4);
  make(mc_he4);

  data_p->SetLineColor(kBlue);
  mc_p->SetLineColor(kRed);

  data_d->SetLineColor(kBlue - 4);
  mc_d->SetLineColor(kRed - 4);

  data_t->SetLineColor(kBlue - 7);
  mc_t->SetLineColor(kRed - 7);

  data_he3->SetLineColor(kBlue - 9);
  mc_he3->SetLineColor(kRed - 9);

  data_he4->SetLineColor(kBlue - 10);
  mc_he4->SetLineColor(kRed - 10);

  double scale_p = 1;
  double scale_d = 5;
  double scale_t = 20;
  double scale_he3 = 50;
  double scale_he4 = 1000;

  /*
  double scale_p = 1;
  double scale_d = 5;
  double scale_t = 15;
  double scale_he3 = 20;
  double scale_he4 = 25;
  */
  /*
  double scale_p = 1;
  double scale_d = 1;
  double scale_t = 1;
  double scale_he3 = 1;
  double scale_he4 = 1;
  */
  //  data_p = (TH1D *)data_p->Rebin(20,"data_p",xbins_h);
  //  mc_p = (TH1D *)mc_p->Rebin(20,"mc_p",xbins_l);
  //  data_p->RebinX(4);
  //  mc_p->RebinX(4);

  //  data_d->RebinX(4);
  //  mc_d->RebinX(4);

  //  data_he4->RebinX(4);
  //  mc_he4->RebinX(4);

  data_p->Scale(scale_p/data_p->Integral(),"width");
  mc_p->Scale(scale_p/mc_p->Integral(),"width");

  data_d->Scale(scale_d/data_d->Integral(),"width");
  mc_d->Scale(scale_d/mc_d->Integral(),"width");

  data_t->Scale(scale_t/data_t->Integral(),"width");
  mc_t->Scale(scale_t/mc_t->Integral(),"width");

  data_he3->Scale(scale_he3/data_he3->Integral(),"width");
  mc_he3->Scale(scale_he3/mc_he3->Integral(),"width");

  data_he4->Scale(scale_he4/data_he4->Integral(),"width");
  mc_he4->Scale(scale_he4/mc_he4->Integral(),"width");

  //  data_p->Fit(polya_h);
  //mc_p->Fit(polya_l);

  data_p->GetXaxis()->SetRangeUser(0,50);
  //  data_p->GetYaxis()->SetRangeUser(0,400);
  data_p->GetYaxis()->SetRangeUser(.001,1000);
  data_p->Draw("");
  mc_p->Draw("same");

  data_d->Draw("same");
  mc_d->Draw("same");

  data_t->Draw("same");
  mc_t->Draw("same");

  data_he3->Draw("same");
  mc_he3->Draw("same");

  data_he4->Draw("same");
  mc_he4->Draw("same");

  data_p->SetMarkerStyle(20);
  mc_p->SetMarkerStyle(20);

  data_d->SetMarkerStyle(21);
  mc_d->SetMarkerStyle(21);

  data_t->SetMarkerStyle(25);
  mc_t->SetMarkerStyle(25);

  data_he3->SetMarkerStyle(24);
  mc_he3->SetMarkerStyle(24);

  data_he4->SetMarkerStyle(23);
  mc_he4->SetMarkerStyle(23);

  data_p->SetMarkerSize(2);
  mc_p->SetMarkerSize(2);
  data_d->SetMarkerSize(2);
  mc_d->SetMarkerSize(2);
  data_he3->SetMarkerSize(2);
  mc_he3->SetMarkerSize(2);
  data_he4->SetMarkerSize(2);
  mc_he4->SetMarkerSize(2);

  data_p->SetMarkerColor(kBlue);
  mc_p->SetMarkerColor(kRed);
  
  data_d->SetMarkerColor(kBlue - 4);
  mc_d->SetMarkerColor(kRed - 4);

  data_t->SetMarkerColor(kBlue - 7);
  mc_t->SetMarkerColor(kRed - 7);

  data_he3->SetMarkerColor(kBlue - 9);
  mc_he3->SetMarkerColor(kRed - 9);

  data_he4->SetMarkerColor(kBlue - 10);
  mc_he4->SetMarkerColor(kRed - 10);

  /*
  auto leg = new TLegend(.3,.2,.7,.5);
  leg->AddEntry(data_p,"Data p","pe");
  leg->AddEntry(mc_p,"MC p","pe");
  leg->AddEntry(data_d,"Data d","pe");
  leg->AddEntry(mc_d,"MC d","pe");
  leg->AddEntry(data_t,"Data t","pe");
  leg->AddEntry(mc_t,"MC t","pe");
  leg->AddEntry(data_he3,"Data 3He","pe");
  leg->AddEntry(mc_he3,"MC 3He","pe");
  leg->AddEntry(data_he4,"Data 4He","pe");
  leg->AddEntry(mc_he4,"MC 4He","pe");
  leg->SetBorderSize(0);
*/

  auto leg = new TLegend(.2,.2,.35,.4);
  leg->AddEntry(data_p,"p","pe");
  leg->AddEntry(data_d,"d","pe");
  leg->AddEntry(data_t,"t","pe");
  leg->AddEntry(data_he3,"{}^{3}He","pe");
  leg->AddEntry(data_he4,"{}^{4}He","pe");
  leg->SetBorderSize(0);
  leg->SetHeader("Data");
  
  auto leg2 = new TLegend(.3,.2,.4,.4);
  leg2->AddEntry(mc_p,"p","pe");
  leg2->AddEntry(mc_d,"d","pe");
  leg2->AddEntry(mc_t,"t","pe");
  leg2->AddEntry(mc_he3,"{}^{3}He","pe");
  leg2->AddEntry(mc_he4,"{}^{4}He","pe");
  leg2->SetBorderSize(0);
  leg2->SetHeader("MC");

  leg->Draw("same");
  leg2->Draw("same");
  cvs->SetLogy();
  cvs->SaveAs("numcluster.png");


}

