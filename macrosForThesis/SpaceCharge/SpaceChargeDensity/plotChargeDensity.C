#include "/home/justin/mythesis/thesis_style.h"
using namespace style;

void plotChargeDensity()
{

  vector<double> run = {2272,2273,2274,2275,2276,2283,2284,2285,2286,2288,2289,2291,2310,2311,2314,2315,2320,2322,2323,2324,2325,2331,2332,2333,2334,2335,2336,2337,2340,2341,2362,2363,2368,2369,2370,2371,2372,2373,2374,2375,2378,2379,2380,2381,2382,2383,2384,2385,2386,2387,2388,2389,2391,2392,2393,2394,2395,2396,2397,2398,2399,2400,2401,2402,2429,2432,2433,2434,2437,2438,2439,2440,2442,2453,2461,2462,2463,2501,2502,2503,2505,2506,2507,2508,2509,2542,2543,2544,2546,2547,2548,2552,2553,2554,2555,2556,2557,2558,2559,2560,2562,2563,2564,2565,2566,2567,2568,2569,2570,2571,2572,2573,2574,2575,2578,2579,2580,2581,2582,2583,2584,2585,2586,2587,2588,2589,2590,2591,2592,2593,2594,2595,2596,2597,2598,2599,2600,2601,2617,2618,2619,2620,2621,2622,2623,2841,2843,2844,2845,2846,2848,2849,2850,2851,2852,2855,2856,2857,2858,2859,2860,2861,2875,2877,2878,2879,2880,2881,2882,2883,2884,2887,2888,2889,2890,2891,2892,2893,2894,2896,2898,2899,2900,2901,2902,2903,2904,2905,2907,2914,2916,2917,2919,2920,2921,2922,2924,2925,2926,2927,2929,2930,2931,2932,2933,2934,2935,2936,2939,2940,2941,2942,2943,2944,2945,2946,2948,2955,2956,2958,2959,2960,2961,2962,2964,2965,2966,2968,2969,2970,2971,2972,2973,2975,2976,2977,2978,2979};


  vector<double> density = {1.09E-08,1.09E-08,9.31E-09,9.99E-09,1.05E-08,1.62E-08,1.56E-08,1.36E-08,1.16E-08,1.08E-08,1.62E-08,1.54E-08,1.17E-08,1.19E-08,8.67E-09,1.07E-08,8.24E-09,1.1E-08,1.09E-08,1.42E-08,1.63E-08,2.08E-08,2.04E-08,2.07E-08,2.37E-08,2.11E-08,2.1E-08,2.29E-08,2.16E-08,2.38E-08,2.02E-08,1.97E-08,2.59E-08,2.31E-08,2.23E-08,2.22E-08,2.02E-08,2.29E-08,2.17E-08,2.21E-08,2.29E-08,1.96E-08,1.73E-08,1.75E-08,1.88E-08,1.67E-08,1.97E-08,2.11E-08,2.26E-08,1.76E-08,1.91E-08,1.88E-08,1.84E-08,1.78E-08,1.81E-08,1.89E-08,1.75E-08,1.56E-08,1.58E-08,1.56E-08,1.73E-08,1.52E-08,1.66E-08,1.59E-08,1.02E-08,7.36E-09,6.86E-09,9.23E-09,1.25E-08,1.09E-08,9.83E-09,1.26E-08,1.03E-08,6.71E-09,1.27E-08,1.12E-08,1.5E-08,2.18E-08,1.85E-08,2.02E-08,1.75E-08,1.63E-08,1.51E-08,1.69E-08,1.76E-08,1.82E-08,1.87E-08,1.57E-08,1.94E-08,1.67E-08,1.63E-08,1.59E-08,1.92E-08,2.3E-08,1.99E-08,2.1E-08,2.04E-08,1.61E-08,1.56E-08,2.19E-08,2.79E-08,2.06E-08,1.73E-08,2.05E-08,2.24E-08,2.73E-08,2.53E-08,2.72E-08,2.77E-08,2.54E-08,2.65E-08,2.47E-08,2.6E-08,2.44E-08,2.43E-08,2.27E-08,2.39E-08,2.17E-08,2.13E-08,1.89E-08,1.68E-08,2.28E-08,2.05E-08,2.28E-08,2.27E-08,2.14E-08,2.21E-08,2.2E-08,2.13E-08,2.09E-08,2.27E-08,2.27E-08,2.16E-08,2.05E-08,2.16E-08,2.02E-08,2.38E-08,2.19E-08,2E-08,1.86E-08,1.9E-08,1.79E-08,1.4E-08,1.95E-08,2.04E-08,4.23E-08,4.29E-08,4.03E-08,3.92E-08,3.9E-08,3.82E-08,3.74E-08,3.96E-08,4.14E-08,4.33E-08,4.14E-08,3.95E-08,4.23E-08,4.26E-08,4.01E-08,4.26E-08,4.17E-08,4.11E-08,4.25E-08,4.31E-08,4.13E-08,3.94E-08,4.18E-08,4.29E-08,3.97E-08,4.21E-08,4.15E-08,4.38E-08,4.21E-08,4.25E-08,4.1E-08,4.53E-08,4.38E-08,4.45E-08,4.26E-08,4.13E-08,4.04E-08,3.91E-08,4.04E-08,4.09E-08,4.05E-08,4.03E-08,4.14E-08,4.24E-08,4.29E-08,4.17E-08,4.17E-08,4.13E-08,4.38E-08,4.28E-08,4.33E-08,3.81E-08,4.05E-08,4.3E-08,4.29E-08,4.36E-08,3.97E-08,3.86E-08,4.17E-08,4.23E-08,4.37E-08,4.35E-08,4.47E-08,4.35E-08,4.31E-08,4.37E-08,4.25E-08,4.68E-08,4.54E-08,4.55E-08,4.6E-08,4.52E-08,4.55E-08,4.5E-08,4.62E-08,4.35E-08,4.63E-08,4.5E-08,4.46E-08,4.48E-08,4.45E-08,4.64E-08,4.29E-08,4.22E-08,4.34E-08,4.42E-08,4.37E-08,4.39E-08,4.5E-08,4.52E-08,4.3E-08,4.31E-08,4.53E-08};

  //  vector<TString> system = {108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,108112,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,112124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124,132124};

  /*
  vector<double> sn108_charge = {1.09E-08,1.09E-08,9.31E-09,9.99E-09,1.05E-08,1.62E-08,1.56E-08,1.36E-08,1.16E-08,1.08E-08,1.62E-08,1.54E-08,1.17E-08,1.19E-08,8.67E-09,1.07E-08,8.24E-09,1.10E-08,1.09E-08,1.42E-08,1.63E-08,2.08E-08,2.04E-08,2.07E-08,2.37E-08,2.11E-08,2.10E-08,2.29E-08,2.16E-08,2.38E-08,2.02E-08,1.97E-08,2.59E-08,2.31E-08,2.23E-08,2.22E-08,2.02E-08,2.29E-08,2.17E-08,2.21E-08,2.29E-08,1.96E-08,1.73E-08,1.75E-08,1.88E-08,1.67E-08,1.97E-08,2.11E-08,2.26E-08,1.76E-08,1.91E-08,1.88E-08,1.84E-08,1.78E-08,1.81E-08,1.89E-08,1.75E-08,1.56E-08,1.58E-08,1.56E-08,1.73E-08,1.52E-08,1.66E-08,1.59E-08,1.02E-08,7.36E-09,6.86E-09,9.23E-09,1.25E-08,1.09E-08,9.83E-09,1.26E-08,1.03E-08,6.71E-09,1.27E-08,1.12E-08,1.50E-08,2.18E-08,1.85E-08,2.02E-08,1.75E-08,1.63E-08,1.51E-08,1.69E-08,1.76E-08};

  vector<double> sn108_run = {  2272,2273,2274,2275,2276,2283,2284,2285,2286,2288,2289,2291,2310,2311,2314,2315,2320,2322,2323,2324,2325,2331,2332,2333,2334,2335,2336,2337,2340,2341,2362,2363,2368,2369,2370,2371,2372,2373,2374,2375,2378,2379,2380,2381,2382,2383,2384,2385,2386,2387,2388,2389,2391,2392,2393,2394,2395,2396,2397,2398,2399,2400,2401,2402,2429,2432,2433,2434,2437,2438,2439,2440,2442,2453,2461,2462,2463,2501,2502,2503,2505,2506,2507,2508,2509};


  vector<double> sn108_br = {6447.754775,6564.360774,6454.116151,6030.224908,5912.894058,8375.336828,8025.150517,-1,6231.624601,5754.54608,7559.237545,6842.341822,6727.01434,7204.549343,6341.650215,6691.84131,5585.45034,6422.640881,6786.595273,7536.039016,7299.978571,9473.403026,9748.727085,10237.10879,10172.2707,10229.88595,9896.685438,9752.511023,10205.60307,10103.5184,9691.448399,10023.13277,10626.78229,10434.53711,9924.428786,10253.96449,10006.88327,9466.111184,10337.03863,9974.842972,9713.388886,9172.090808,7873.414342,8764.186462,8624.55414,8253.959558,8823.805076,9679.625279,9596.013369,9464.396016,9201.327359,9308.851807,8923.525037,9334.935935,9073.120424,8893.716063,8667.898944,8792.549025,8437.483558,8189.876221,8313.203752,8221.351804,8158.488776,8104.937279,6993.436278,5935.47833,5784.5966,5807.9583,7192.362745,7035.693289,6909.312953,6920.646688,6677.013504,5768.80305,6582.155683,6042.88454,7117.558223,9911.882983,9117.447041,8981.492782,8920.779208,8635.417197,8600.713511,8788.418931,8915.186004};

  vector<double>  sn132_run ={2841,2843,2844,2845,2846,2848,2849,2850,2851,2852,2855,2856,2857,2858,2859,2860,2861,2875,2877,2878,2879,2880,2881,2882,2883,2884,2887,2888,2889,2890,2891,2892,2893,2894,2896,2898,2899,2900,2901,2902,2903,2904,2905,2907,2914,2916,2917,2919,2920,2921,2922,2924,2925,2926,2927,2929,2930,2931,2932,2933,2934,2935,2936,2939,2940,2941,2942,2943,2944,2945,2946,2948,2955,2956,2958,2959,2960,2961,2962,2964,2965,2966,2968,2969,2970,2971,2972,2973,2975,2976,2977,2978,2979};

vector<double> sn132_br = {9667.49575,8864.689657,7894.969737,7892.279975,8095.52008,-1,8178.904879,8444.329807,8883.548585,9231.212433,9006.418923,6448.506771,9152.405692,9472.937812,9127.510679,9689.263742,9713.430552,9429.595417,9674.502405,9933.033472,8986.159117,9277.956558,9572.079669,9681.687897,9396.762902,8544.606877,9021.344144,9930.295987,10023.09286,9532.346729,8861.571547,6806.406888,9052.890288,9890.588031,9628.720524,9686.903903,8493.787126,8986.438439,9032.604118,8894.141273,8652.580504,8527.349213,9505.113859,9350.59836,8457.671921,9466.431554,9575.166096,9867.257951,9938.911297,10158.49689,9841.428,7594.157452,9029.006934,9636.481122,10022.09208,9021.31591,8454.499252,8798.653066,9541.458351,10025.0994,10201.36338,10206.77701,10158.88062,10020.13161,10317.14867,10184.53125,9889.614352,10645.75798,10090.67909,10460.77917,10603.79618,10571.74734,10238.67525,10283.508,10583.52239,10372.58058,10500.96017,9789.086097,10439.34519,10648.44532,10707.37109,10660.85363,9257.515574,9688.242987,10221.40773,8902.587363,10247.81567,10143.98708,10252.73442,10141.03608,10646.28973,10177.34285,10588.72378};


vector<double> sn132_charge = {4.23E-08,4.29E-08,4.03E-08,3.92E-08,3.90E-08,3.82E-08,3.74E-08,3.96E-08,4.14E-08,4.33E-08,4.14E-08,3.95E-08,4.23E-08,4.26E-08,4.01E-08,4.26E-08,4.17E-08,4.11E-08,4.25E-08,4.31E-08,4.13E-08,3.94E-08,4.18E-08,4.29E-08,3.97E-08,4.21E-08,4.15E-08,4.38E-08,4.21E-08,4.25E-08,4.10E-08,4.53E-08,4.38E-08,4.45E-08,4.26E-08,4.13E-08,4.04E-08,3.91E-08,4.04E-08,4.09E-08,4.05E-08,4.03E-08,4.14E-08,4.24E-08,4.29E-08,4.17E-08,4.17E-08,4.13E-08,4.38E-08,4.28E-08,4.33E-08,3.81E-08,4.05E-08,4.30E-08,4.29E-08,4.36E-08,3.97E-08,3.86E-08,4.17E-08,4.23E-08,4.37E-08,4.35E-08,4.47E-08,4.35E-08,4.31E-08,4.37E-08,4.25E-08,4.68E-08,4.54E-08,4.55E-08,4.60E-08,4.52E-08,4.55E-08,4.50E-08,4.62E-08,4.35E-08,4.63E-08,4.50E-08,4.46E-08,4.48E-08,4.45E-08,4.64E-08,4.29E-08,4.22E-08,4.34E-08,4.42E-08,4.37E-08,4.39E-08,4.50E-08,4.52E-08,4.30E-08,4.31E-08,4.53E-08};


  TGraph *density_132 = new TGraph(sn132_run.size());
  TGraph *density_108 = new TGraph(sn108_run.size());
  TH1D *br_132 = new TH1D("br_132","br_132",10,6000,12000);
  TH1D *br_108 = new TH1D("br_108","br_108",10,6000,12000);

  for(int i = 0; i < sn132_run.size(); i++)
    {
      density_132->SetPoint(i,sn132_br.at(i),sn132_charge.at(i));
      br_132->Fill(sn132_br.at(i));
    }

  for(int i = 0; i < sn108_run.size(); i++)
    {
      density_108->SetPoint(i,sn108_br.at(i),sn108_charge.at(i));
      br_108->Fill(sn108_br.at(i));
    }

  density_132->SetMarkerStyle(20);
  density_132->SetMarkerSize(2);
  density_132->SetMarkerColor(2);

  density_108->SetMarkerStyle(20);
  density_108->SetMarkerSize(2);
  density_108->SetMarkerColor(4);

  density_132->Draw("APO");
  density_132->GetYaxis()->SetRangeUser(1e-8,5e-8);
  density_108->Draw("same PO");
  */

  TGraph *density_g = new TGraph(density.size());

  for(int i = 0; i < density.size(); i++)
    {
      density_g->SetPoint(i,run.at(i),density.at(i));
    }

  density_g->SetMarkerColor(2);
  density_g->SetMarkerStyle(20);
  density_g->SetMarkerSize(2);
  density_g->Draw("APO");



  /*
  br_132->SetLineColor(2);
  br_108->SetLineColor(4);  
  br_132->Draw();
  br_108->Draw("same");
  */
}
